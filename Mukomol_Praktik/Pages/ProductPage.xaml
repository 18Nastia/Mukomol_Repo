<Page x:Class="Mukomol_Praktik.Pages.ProductPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="clr-namespace:Mukomol_Praktik.Pages"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      mc:Ignorable="d"
      d:DesignHeight="450" d:DesignWidth="800"
      Title="ProductPage">

    <Page.Resources>

        <!-- Конвертер -->
        <local:BoolToVisibilityConverter x:Key="BoolToVisibility" />

        <!-- Шаблон Муки -->
        <DataTemplate x:Key="FlourTemplate">
            <Border Width="220" Padding="10" Margin="10"
                    Background="White" CornerRadius="12"
                    BorderBrush="#DDD" BorderThickness="1">
                <StackPanel>
                    <TextBlock Text="{Binding Name}" 
                               FontWeight="Bold" FontSize="16" TextWrapping="Wrap"/>

                    <TextBlock Text="ГОСТ:" FontWeight="Bold" Margin="0,5,0,0"/>
                    <TextBlock Text="{Binding Gost}"/>

                    <TextBlock Text="Клейковина:" FontWeight="Bold" Margin="0,5,0,0"/>
                    <TextBlock Text="{Binding Gluten}"/>

                    <TextBlock Text="Белизна:" FontWeight="Bold" Margin="0,5,0,0"/>
                    <TextBlock Text="{Binding White}"/>
                </StackPanel>
            </Border>
        </DataTemplate>
        
        <!-- Шаблон Макарон -->
        <DataTemplate x:Key="PastaTemplate">
            <Border Width="220" Padding="10" Margin="10"
            Background="White" CornerRadius="12"
            BorderBrush="#DDD" BorderThickness="1">
                <StackPanel>

                    <Image Source="{Binding ImagePath}" Height="140"
                   Stretch="Uniform" Margin="0,0,0,10"/>

                    <TextBlock Text="{Binding Name}" FontWeight="Bold" FontSize="16"/>
                    <TextBlock Text="{Binding Brand}" Foreground="Gray"/>

                    <!-- Показываем блок веса ТОЛЬКО если Type = PastaPackaged -->
                    <StackPanel Margin="0,5,0,0"
                        Visibility="{Binding IsPackaged,
                                     Converter={StaticResource BoolToVisibility}}">
                        <TextBlock>
                    <Run Text="Вес: "/>
                    <Run Text="{Binding Packaging}"/>
                        </TextBlock>
                    </StackPanel>

                </StackPanel>
            </Border>
        </DataTemplate>


        <!-- Выбор шаблона -->
        <local:ProductTemplateSelector x:Key="ProductTemplateSelector"
                                       FlourTemplate="{StaticResource FlourTemplate}"
                                       PastaTemplate="{StaticResource PastaTemplate}"/>
    </Page.Resources>

    <Grid>

        <!-- Верхняя панель -->
        <Grid Background="#f1cf69" Height="80" VerticalAlignment="Top">

            <Image Source="/Image/logo-mukomol.png"
           Width="50" Height="60"
           HorizontalAlignment="Left"
           VerticalAlignment="Center"
           Margin="50,0,0,0"
           MouseDown="ToMain"/>

            <TextBlock Text="Партнеры"
               HorizontalAlignment="Right"
               VerticalAlignment="Center"
               FontSize="16"
               Foreground="White"
               Margin="0,0,340,0"
               MouseDown="ToPartner"/>

            <TextBlock Text="Продукция"
               HorizontalAlignment="Right"
               VerticalAlignment="Center"
               FontSize="16"
               Foreground="Gray"
               Margin="0,0,245,0"/>

            <TextBlock Text="Заказы"
               HorizontalAlignment="Right"
               VerticalAlignment="Center"
               FontSize="16"
               Foreground="White"
               Margin="0,0,180,0"
               MouseDown="ToOrder"/>

            <TextBlock Text="Отгрузки"
               HorizontalAlignment="Right"
               VerticalAlignment="Center"
               FontSize="16"
               Foreground="White"
               Margin="0,0,100,0"
               MouseDown="ToShipment"/>

            <TextBlock Text="Отчёты"
               HorizontalAlignment="Right"
               VerticalAlignment="Center"
               FontSize="16"
               Foreground="White"
               Margin="0,0,30,0"
               MouseDown="ToReport"/>
        </Grid>

        <!-- НАЗАД -->
        <Image Source="/Image/icon-strelka.png"
       HorizontalAlignment="Left"
       Height="33"
       Margin="30,120,0,0"
       VerticalAlignment="Top"
       Width="37"
       MouseDown="ToBack"/>

        <!-- Заголовок -->
        <TextBlock Text="Продукция" FontSize="30" FontWeight="Bold"
           Foreground="#041e56"
           HorizontalAlignment="Center" Margin="0,110,0,0"/>

        <Grid Margin="0,160,0,0">

            <StackPanel Orientation="Horizontal" Margin="20,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">

                <!-- Мука -->
                <Border Background="#041e56" BorderBrush="#041e56" BorderThickness="1" Padding="5" Margin="0,0,10,0" CornerRadius="6">
                    <CheckBox x:Name="FlourCheckBox" Content="Мука" IsChecked="True"
                  Checked="FilterChanged" Unchecked="FilterChanged"
                  Foreground="White" FontWeight="Bold" FontSize="14"
                  Cursor="Hand"/>
                </Border>

                <!-- Фасованные макароны -->
                <Border Background="#041e56" BorderBrush="#041e56" BorderThickness="1" Padding="5" Margin="0,0,10,0" CornerRadius="6">
                    <CheckBox x:Name="PackagedPastaCheckBox" Content="Макароны фасованные" IsChecked="True"
                  Checked="FilterChanged" Unchecked="FilterChanged"
                  Foreground="White" FontWeight="Bold" FontSize="14"
                  Cursor="Hand"/>
                </Border>

                <!-- Весовые макароны -->
                <Border Background="#041e56" BorderBrush="#041e56" BorderThickness="1" Padding="5" Margin="0,0,10,0" CornerRadius="6">
                    <CheckBox x:Name="BulkPastaCheckBox" Content="Макароны весовые" IsChecked="True"
                  Checked="FilterChanged" Unchecked="FilterChanged"
                  Foreground="White" FontWeight="Bold" FontSize="14"
                  Cursor="Hand"/>
                </Border>

            </StackPanel>


            <ScrollViewer Margin="20,50,20,20">
                <ItemsControl ItemsSource="{Binding FilteredProducts}"
                              ItemTemplateSelector="{StaticResource ProductTemplateSelector}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </ScrollViewer>

        </Grid>
    </Grid>
</Page>
